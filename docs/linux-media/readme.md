<!-- Date: 2017-04-24 01:32:08 -->

# linux 挂载设备和硬件管理

### 挂载设备------------------------------------------------------------------

#### 如何挂载新的设备？

mount -t [文件系统类型][特殊选项，特殊选项] 设备位置 挂载点

以挂载新光盘为例：

新建挂载点：系统根目录下默认给出了 media misc mnt 三个外来设备挂载点，但是推荐直接在 mnt 下新建挂载点

mkdir /mnt/cdrom

#### 挂载光盘：

mount -t iso9660 /dev/sr0 /mnt/cdrom

这个里面的 -t 是可以省略的，因为 Linux 系统知道 sr0 是一个光盘文件，因此他的默认文件类型就是 iso9660

因此这个可以省略

使用 mount 命令挂载的设备是一次性的，如果需要每次开机都自动挂载，需要配置/etc/fstab 文件，里面添加 设备名称 挂载点 文件系统类型 defaults 0 0, 保存退出。

mount -a 命令自动挂载/etc/fstab 文件中的所有设备

#### 挂载新设备的特殊选项：

| 参数                 | 说明                                                                         |
| -------------------- | ---------------------------------------------------------------------------- |
| atime/noatime        | 询问分区文件是，是否更新文件的访问时间，默认为更新                           |
| async/sync           | 默认为异步                                                                   |
| auto/noauto mount -a | 命令执行时，是否会自动安装/etx/fstab 文件内容挂载，默认为自动                |
| default              | 定义默认只，相当于 rw,suid,dev,exc,auto,nouser,async 这七个选项              |
| exec/remount         | 设备是否允许在文件系统中执行可执行文件，默认是 exec 允许                     |
| remount              | 重新挂载已经挂载的文件系统，一半用于指定修改特殊权限                         |
| rw/ro                | 文件系统挂载时，是否局与偶读写权限，默认是 rw                                |
| suid/nosuid          | 设定文件系统是否具有 SUID 和 SGID 的权限，默认是具有                         |
| user/nouser          | 设定文件系统是否允许普通该用户挂载，默认是不允许，只有 root 用户可以挂载分区 |
| usrquota             | 写入代表文件系统支持用户磁盘配额，默认不支持                                 |
| grpquota             | 写入代表文件系统支持组磁盘配额，默认不支持                                   |
| Linux                | 默认是不支持 NTFS 文件系统的                                                 |

挂载 NTFS 分区 ，是不推荐使用的，可以使用 网络传输文件 的方式来打开文件

#### 如何查询用户登录信息

| 命令    | 用法                                                       |
| ------- | ---------------------------------------------------------- |
| USER \_ | 登录的用户名                                               |
| TTY     | 登录终端                                                   |
| FROM    | 从哪个 IP 登录                                             |
| LOGIN   | 登录时间                                                   |
| IDLE    | 用户闲置时间                                               |
| JCPU    | 与该终端连接的所有进程占用的时间，不包括过去的后台作业时间 |
| PUPU    | 当前进程所占用的时间                                       |
| WHAT    | 当前正在运行的命令                                         |

### 硬盘操作----------------------------------------------------------------

#### CentOS6.5 下的硬盘分区操作

* 常用分区概念

```
主分区和扩展分区总数不能超过4个
扩展分区最多只能有一个
扩展分区不能直接存取数据
扩展分区必须添加逻辑分区才能存取数据
```

#### MBR 分区与 GPT 分区的区别

MBR：

* 主分区不得超过 4 个
* 单个分区容量最大 2TB
* 只能创建 MBR 分区 GPT：
* 主分区个数“几乎”没有限制
* 单个分区容量“几乎”没有限制（18EB）
* 没有主分区、扩展分区的概念
* 既可以创建 MBR 分区，也可以创建 GPT 分区
* 注意： GPT 分区不适合安装 x86 操作系统，也就是 32 位系统

#### 使用 fdisk 创建 MBR 分区

```
fdisk           //查看磁盘信息
fdisk -l        //查看所有磁盘详细信息(包含分区名称等信息)
fdisk /dev/sdb  //选择需要分区的磁盘，进入分区命令模式
p               //查看所选磁盘分区信息
u               //切换信息显示单位(扇区、数据块)
n               //创建新的磁盘分区
p               //创新主分区 (如果是扩展分区，是e)1//设置分区名称(遵循MBR分区规则)0//设置默认开始扇区位置（字节位置）
                //，如果直接回车就是使用默认提示的值1000//设置结束扇区位置(字节位置)，也可以使用+1000M(K,G)的方式直接设置
w               //保存分区修改信息
d               //删除指定分区
1               //选择要删除的分区号
```

其他：

#### 使用 parted 创建 GPT 分区(需要安装 parted 包)

```
parted              //进入分区命令模式
select /dev/sdc     //选择要创建分区的磁盘
unit GB             //选择使用GB的方式，显示磁盘信息
mklabel gpt         //选择分区表类型 (MBR类型为msdos，GPT类型分为gpt)
print all           //显示所有硬盘的分区信息，如果只是print 则只查看当前选择的磁盘的分区信息
mkpart              //添加分区
liyun               //给分区添加一个名称，类似于window的卷标，可以直接回车跳过
ext2                //指定分区文件类型，默认是ext21//分区的开始位置，单位是M2000//分区的结束位置,单位是M
cancel              //如果提示分区未对其，需要输入这个cancel重新指定分区开始、结束位置类似于平常说的4k对齐
mkpart test 20003000// 这是创建分区的命令模式 (mkpart 分区名称 开始位置 结束位置),分区的名称是不能省略的
rm 3//删除指定序号的分区
quit                //退出分区(这里要注意fdisk里面需要w命令把分区信息写入硬盘，而parted工具，是即时生效的，只需要退出即可)
```

#### 格式化分区

不管是 MBR 还是 GPT 都可以使用 mkfs 命令格式化分区

`mkfs.ext4 /dev/sdb1`

或者另一种写法：

`mkfs -t ext4 /dev/sdb1`

MBR 中的扩展分区是不支持格式化的 ，只有主分区和逻辑分区才能格式化
GPT 中的分区只能使用 parted 工具才能查看分区信息，不能使用 fdisk 工具查看

#### 如何为硬盘添加 swap 交换分区

建立一个普通的 Linux 分区

修改分区类型为 16 进制编码

格式化交换分区

启用交换分区

```
fdisk /dev/sdb      //使用fdisk工具选择磁盘
t                   //修改分区系统类型
6                   //选择被修改类型的分区
L                   //查看所有的分区类型
82                  //选择Linux swap类型序号
w                   //写入分区修改
mkswap /dev/sdb6    //格式化交换分区(注意这里的格式化和格式化其他分区不一样的)
swapon /dev/sdb6    //启用交换分区
```
