# 用户和用户组管理

### 用户和用户组---------------------------------------------------------------

#### 用户组

* 用户组的信息都保存在`/etc/group`
* 格式：`组名称：组密码占位符：组编号：组中用户名列表`
* 当组名称和他里面唯一的一个用户名名称一致的时候，后面的列表显示是空的
* 超级用户的用户组组号一定是 0
* 组号 1-499 是属于系统预留主编号，一般是预留给安装早系统中的软件的，越早安装的软件分配的组编号越小
* 用户手动创建的组编号是从 500 开始
* 主密码占位符全部是用`x`表示

#### 用户组密码

* 用户组的组密码信息保存在`/etc/gshadow`
* 格式： `组名称：组密码：组管理者：组中用户名列表`
* 组密码为空或者为\* 或者！ 标示组的密码是空的，也就是说该组是没有密码的
* 组管理者一般情况下都是空的，那就是说组内的所有用户都可以管理这个用户组

#### 用户文件

* 存储所有用户的文件信息`/etc/passwd`
* 格式：`用户名：密码占位符：用户编号：用户组编号：用户用注释信息：用户主目录：shell类型`

#### 用户密码

* 存储所有用户的密码信息`/etc/shadow`
* 格式： `用户名：密码：其他信息`

创建新用户的时候，如果没有指定用户组，系统将创建一个与用户名相同的用户组，并把该用户放在用户组中

创建新用户的时候，如果没有指定家目录，系统会在 home 中自动创建一个与用户名相同的文件夹作为该用户的家目录

| 用户组命令命令          | 作用                                                                          |
| ----------------------- | ----------------------------------------------------------------------------- |
| groupadd sexy           | 创建一个名为 sexy 的组                                                        |
| groupmod -n market sexy | 把 sexy 的组名改为 market                                                     |
| groupmod -g 668 market  | 把 market 的组编号改为 668                                                    |
| groupadd -g 888 boss    | 创建一个名为 boss 的用户组并指定编号为 888                                    |
| groupdel market         | 删除组 market，删除用户组之前必须删除组内用户，会变成系统黑户口，很容易出问题 |
| groups groupname        | 查看用户组里面的用户                                                          |
| groups username         | 查询用户所属的用户组用户命令                                                  |

| 命令                       | 作用                                                                         |
| -------------------------- | ---------------------------------------------------------------------------- |
| useradd user               | 创建一个新用户，如果没有指定用户组，则创建一个同名的用户组，和一个同名家目录 |
| useradd -g sexy sdf        | 把用户 sdf 添加到 sexy 组里面                                                |
| useradd -d /home/xxx imooc | 并指定他的家目录为/home/xxx，                                                |
| usermod -G new sdf         | 把用户 sdf 附加到用户组 new 里面                                             |
| usermod -c dgdzmx sdf      | 修改用户 sdf 的备注信息                                                      |
| usermod -l cls sdf         | 直接修改用户名，新名字在前，旧的在后面                                       |
| usermod -d /home/cls       | 修改用户 cls 的家目录                                                        |
| userdel jzmb               | 删除用户                                                                     |
| userdel -r jzmb            | 删除用户并删除他的个人文件                                                   |
| touch /etc/nologin         | 创建一个空的文件，来禁止除了管理员以外的用户进入服务器                       |
| passwd                     | 修改当前用户的密码                                                           |
| passwd username            | 修改用户的密码                                                               |
| passwd -l username         | 锁定用户的账户                                                               |
| passwd -u username         | 解锁账户                                                                     |
